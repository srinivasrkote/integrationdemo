================================================================================
TEST CLAIM SUBMISSION FOR JOHN DOE (BCBS MEMBER)
================================================================================

Patient Information:
--------------------
Name: John Doe
Member ID: MEM-BC-001
Insurance ID: BC-789-456
Date of Birth: June 15, 1985 (1985-06-15)
Gender: Male
Status: Active

Insurance Details:
------------------
Payor: BlueCross BlueShield (PAY001)
Current Policy: BC-789-456-123
Plan Name: BlueCross Gold Plan
Policy Status: Active
Effective Date: January 1, 2024
Coverage Period: 2024-01-01 to 2024-12-31

Medical Conditions (for reference):
-----------------------------------
1. Type 2 Diabetes (ICD-10: E11.9)
   - Diagnosed: March 15, 2020
   - Severity: Moderate
   - Status: Active

2. Hypertension (ICD-10: I10)
   - Diagnosed: August 22, 2018
   - Severity: Mild
   - Status: Active

Deductible Status:
------------------
Deductible Met: $1,200
Out-of-Pocket Met: $2,500

================================================================================
UI TEST INSTRUCTIONS - SUBMIT CLAIM VIA PROVIDER DASHBOARD
================================================================================

Step 1: Access Provider Dashboard
----------------------------------
1. Open browser to: http://localhost:8001
2. Ensure you're logged in as "Provider2"
3. Click "Submit New Claim" button

Step 2: Fill Patient Information
---------------------------------
Patient Name: John Doe
Insurance ID: BC-789-456
   ⚠️ IMPORTANT: Use BC-789-456 (not MEM-BC-001)
   This is the insurance_id that maps to BlueCross in payor_integration.py

Step 3: Use Medical Codes Cheatsheet
-------------------------------------
1. Click "Medical Codes Reference" button (should open modal)
2. Search for "diabetes" 
3. Click on code: E11.9 - Type 2 diabetes mellitus without complications
   ✓ Should auto-fill Diagnosis Code and Description
4. Switch to "CPT Codes" tab
5. Search for "office visit"
6. Click on code: 99214 - Office/outpatient visit, established patient, moderate complexity
   ✓ Should auto-fill Procedure Code and Description

Step 4: Fill Remaining Fields
------------------------------
Service Date: 2025-10-03 (or today's date)
Amount: $250.00 (matches CPT 99214 price)

Step 5: Submit Claim
--------------------
1. Click "Submit Claim" button
2. Watch for success/error messages

================================================================================
EXPECTED RESULTS
================================================================================

✓ Medical Codes modal opens when clicking "Medical Codes Reference"
✓ Search functionality works in modal
✓ Clicking codes auto-fills form fields:
  - Diagnosis Code: E11.9
  - Diagnosis Description: Type 2 diabetes mellitus without complications
  - Procedure Code: 99214
  - Procedure Description: Office/outpatient visit, established patient, moderate complexity

✓ Claim submission creates local MongoDB record
✓ Claim is forwarded to payor system via provider-payor API
✓ Success response includes payor_claim_id
✓ Claim visible in dashboard claims list

================================================================================
ALTERNATIVE TEST SCENARIOS
================================================================================

Test Scenario 2: Hypertension Visit
------------------------------------
Patient: John Doe
Insurance ID: BC-789-456
Diagnosis: I10 - Essential (primary) hypertension
Procedure: 99213 - Office/outpatient visit, established patient, low complexity
Amount: $150.00
Service Date: Today

Test Scenario 3: Routine Checkup
---------------------------------
Patient: John Doe
Insurance ID: BC-789-456
Diagnosis: Z00.00 - Encounter for general adult medical examination without abnormal findings
Procedure: 99203 - Office/outpatient visit, new patient, low complexity
Amount: $275.00
Service Date: Today

Test Scenario 4: Combined Diabetes + Hypertension
--------------------------------------------------
Patient: John Doe
Insurance ID: BC-789-456
Diagnosis: E11.9 (primary), I10 (secondary)
   Note: Form may only support single diagnosis code
Procedure: 99215 - Office/outpatient visit, established patient, high complexity
Amount: $350.00
Service Date: Today

================================================================================
TROUBLESHOOTING
================================================================================

Issue: Medical Codes modal doesn't open
Solution: 
- Check browser console (F12) for errors
- Verify Vite dev server is running (port 3001)
- Try refreshing page (Ctrl+R)
- Check if dialog.jsx fix was applied

Issue: "DisallowedHost" error when submitting
Solution:
- Ensure payor system is running (port 8000)
- Add ngrok domain to payor's ALLOWED_HOSTS
- Or set ALLOWED_HOSTS = ['*'] in payor's settings.py

Issue: Claim not forwarding to payor
Solution:
- Check PAYOR_BASE_URL in .env file
- Verify ngrok tunnel is active
- Check claims/payor_integration.py has BC-789-456 mapping

Issue: Auto-fill not working
Solution:
- Verify handleCodeSelect function in ProviderDashboard.jsx
- Check console for JavaScript errors
- Ensure MedicalCodesCheatsheet has onCodeSelect prop

================================================================================
API ENDPOINT USED
================================================================================

Provider System:
POST http://localhost:8001/api/provider/submit-claim/

Request Body:
{
  "patient_name": "John Doe",
  "insurance_id": "BC-789-456",
  "diagnosis_code": "E11.9",
  "procedure_code": "99214",
  "amount": 250.00,
  "service_date": "2025-10-03"
}

Expected Response:
{
  "status": "success",
  "message": "Claim submitted successfully",
  "claim_id": "mongodb_object_id",
  "payor_claim_id": "payor_system_claim_id",
  "payor_response": { ... }
}

================================================================================
VERIFICATION CHECKLIST
================================================================================

Before Submission:
☐ Provider dashboard loads successfully
☐ "Submit New Claim" button visible
☐ "Medical Codes Reference" button visible in claim form

During Code Selection:
☐ Modal opens when clicking "Medical Codes Reference"
☐ Search bar functional
☐ ICD-10 and CPT tabs switch correctly
☐ Codes are categorized with colored badges
☐ Clicking code auto-fills form fields
☐ Modal closes after selection

After Submission:
☐ Success message displays
☐ Claim appears in dashboard table
☐ Claim has status (Submitted/Pending)
☐ Payor response includes claim ID
☐ No console errors in browser

Database Verification (Optional):
☐ Check MongoDB: db.claims.find({patient_name: "John Doe"})
☐ Verify payor_claim_id exists in record
☐ Check payor system database for received claim

================================================================================
QUICK COPY-PASTE TEST DATA
================================================================================

Patient Name: John Doe
Insurance ID: BC-789-456
Diagnosis Code: E11.9
Diagnosis Description: Type 2 diabetes mellitus without complications
Procedure Code: 99214
Procedure Description: Office/outpatient visit, established patient, moderate complexity
Service Date: 2025-10-03
Amount: 250.00

================================================================================
NOTES
================================================================================

1. Member ID (MEM-BC-001) is for payor's internal use
2. Insurance ID (BC-789-456) is what provider uses for claim submission
3. John Doe has active conditions matching ICD-10 codes E11.9 and I10
4. Policy is currently active (expires Dec 31, 2024)
5. Deductible is partially met ($1,200 of total)
6. Patient has Penicillin allergy - avoid related medications

================================================================================
SUCCESS CRITERIA
================================================================================

✓ Medical Codes Cheatsheet modal opens and functions correctly
✓ Code selection auto-fills diagnosis and procedure fields
✓ Claim submits without errors
✓ Claim saved to provider's MongoDB
✓ Claim forwarded to payor system via API
✓ Payor responds with claim ID
✓ Claim visible in provider dashboard

================================================================================
